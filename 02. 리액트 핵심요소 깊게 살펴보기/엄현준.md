# 02장: 리액트 핵심 요소 깊게 살펴보기

## 2.1 JSX란?

### 2.1.1 JSX의 정의

- JSX는 자바스크립트 내부에서 표현하기 까다로웠던 XML 스타일의 트리 구문을 작성하는데 도움을 주는 새로운 문법
- 페이스북에서 독자적으로 개발 (ECMAScript, 자바스크립트 표준 아님)
- 트랜스파일 과정에서 트리 구조를 토큰화해 표준으로 변환하는것이 목적

## 2.2 가상 DOM과 리액트 파이버

### 2.2.1 DOM과 브라우저 렌더링 과정

### 2.2.2 가상 DOM의 탄생 배경

**_가상 DOM 탄생 배경_**

- 웹페이지 렌더링 과정 = 복잡, 비용 많이 듦
- 요즘 앱 → 인터렉션을 통한 다양한 페이지 변화를 고려해야 함.
- 개발자 입장에서 DOM의 모든 변경 사항 추적하기보다 결과물만 알고 싶음.

**_가상DOM에 대한 오해_**

- 브라우저의 DOM보다 빠르다. (x)
- 웬만한 어플리케이션을 만들 정도로 빠르다 (o)

### 2.2.3 가상 DOM을 위한 아키텍처, 리액트 파이버

- 가상 DOM을 통해, 리액트는 여러번의 렌더링을 압축함.
- 가상 DOM은 리액트 파이버를 이용해서 다룸.

**_리액트 파이버_**

- 리액트에서 관리하는 평범한 자바스크립트 객체
- 파이버는 파이버 재조정자(fiber-reconciler)가 관리

**_리액트팀이 말하는 리액트_**

- 가상 DOM이 아닌, Value UI, 값을 가지고 있는 UI를 관리하는 라이브러리
- 리액트의 핵심원칙: UI를 문자열, 숫자, 배열과 같은 값으로 관리
- 리액트 = 변수에 UI 관련 값을 보관 → 자바스크립트 코드 흐름에 따라 관리, 표현하는 것

**_리액트 파이버 트리_**

- 파이버 트리는 2개 존재 (current,workInProcess )
- 더블 버퍼링 (그래픽 용어)
  - 그림을 미리 그린 다음 -> 현재 상태만 변경하여 보여주는 방식
  - 리액트 파이버: 작업이 끝나면 포인터만 변경해 workInProcess트리를 → 현재 트리로 바꿈

## 2.4 렌더링은 어떻게 일어나는가?

### 2.4.1 리액트의 렌더링이란?

브라우저 렌더링에 필요한 DOM트리를 만드는 과정

### 2.4.2 리액트의 렌더링이 일어나는 이유

- 최초 렌더링

  - 처음 진입 시 렌더링

- 리렌더링

  - 최초 이후의 모든 렌더링

  - 리렌더링이 발생하는 경우

    1. 클래스 컴포넌트의 setState가 실행되는 경우
    2. 클래스 컴포넌트의 forceUpdate가 실행되는 경우
    3. 함수 컴포넌트의 useState의 두번째 배열 요소인 setter가 실행되는 경우
    4. 함수 컴포넌트의 useReducer의 두번째 배열 요소인 dispatch가 실행되는 경우
    5. 컴포넌트의 key props가 변경되는 경우
    6. props가 변경되는 경우
    7. 부모 컴포넌트가 렌더링 될 경우

    위의 경우에만 렌더링이 일어남.

### 2.4.3 리액트의 렌더링 프로세스

### 2.4.4 렌더와 커밋

**렌더 단계**

- 컴포넌트를 렌더링하고 변경 사항을 계산하는 모든 작업
- 컴포는트를 실행해(render(), return) 결과와 이전 가상 DOM을 비교하는 과정을 거쳐 필요한 컴포넌트를 체크하는 단계
- 비교하는 것은 크게 세가지. → type, props, key
  셋 중 하나라도 변경되면, 변경이 필요하다고 체크함

**커밋 단계**

- 렌더 단계의 변경 사항을 실제 DOM에 적용해 사용자에게 보여주는 과정
- 이 단계 끝나고 브라우저의 렌더링이 발생함
- 커밋 단계에서 DOM 업데이트를 하면

  - 모든 DOM 노드 및 인스턴스를 가리키도록 리액트 내부 참조를 업데이트

- 렌더링이 일어난다고해서 무조건 DOM 업데이트가 일어나지 않음
- 렌더링 후 변경 사항이 감지되지 않는다면 커밋 단계 생략 가능
-

## 2.5 컴포넌트와 함수의 무거운 연산을 기억해 두는 메모이제이션

### 2.5.1 주장 1: 섣부른 최적화는 독이다, 꼭 필요한 곳에만 메모이제이션을 추가하자

- 꼭 필요한 곳에만 적용하는 방법
- 메모제이션은 비용이 든다. (렌더링, 캐싱 등등)

### 2.5.2 주장 2: 렌더링 과정의 비용은 비싸다, 모조리 메모이제이션해 버리자

- 모든 곳에 일단 적용하고 보는 방법
- 메모제이션 비용이 크지 않다.

### 2.5.3 결론 및 정리

**_저자의 의견_**

- 리액트를 깊이 이해하고 싶거나, 시간의 여유가 있다면 -> 1번
- 시간이 없다면 -> 2번
